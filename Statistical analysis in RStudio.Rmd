---
title: "Statistical analysis in RStudio"
output:
  pdf_document:
    keep_tex: yes
    extra_dependencies: "subfig"
    toc: yes
    toc_depth: 2
    number_sections: yes
  html_document:
    toc: yes
    toc_depth: '2'
    df_print: paged
  word_document:
    toc: yes
    toc_depth: '2'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(tinytex.verbose = TRUE)
library(knitr)
library(readxl)
library(pastecs)
library(tidyverse)
library(tinytex)
library(equatiomatic)
library(stringr)
library(ggplot2)
library(Rmisc)
```
### Abstact


# INTRODUCTION



The main objective of statistical analysis is to find the correlation and Trends of seal abundance  using the serial dataset.

Firstly we will download the data and convert it into a csv file and then import data into R studio after importing data We will read the data and convert the data into data frame Which will import data into rows and columns.
If we check the head of data we can find There are  5 columns 210 observations.

* The first column represents  the year, each row consists of the year from 2007 to 2010.
* The second column represents the month of a specific year; there are 15 unique variables if it presents the month of a particular Year.
* The third column represents a site  which consists of 7 unique variables A,B,C,D,Split and Wall.
* The fourth column represents species which have true unique species  Harbour and grey.
* The final column represents the average count of each species in a particular year year and month each variable has a unique  count value.

After looking at the column if we check the structure of data,the  first four columns represent the character data type, the last column that is average count represents the numerical data type. 

After getting  familiar with the data set ,the first four column data type should be changed to factor type as in which column the variable of rows  are repetitive.



```{r, echo=FALSE}
## Importing Data

data <- read.csv("Seal averages 2007-2010.csv", header = T)

## Converting Data to data frame
data <- data.frame(data)

# Checking first 6 six rows of data
kable(head(data))


```
```{r, echo=F}
# Checking  structure of data 
str(data)

```
```{r,echo=FALSE}
##Converting data types 

###Removing string "Summer-" from Column Summer for Better understanding 
data$Summer <- str_remove_all(data$Summer, "[summer-]")

### Converting Summer Column data type to Factor
data$Summer <- as.factor(data$Summer)

### Converting Year.Month Column data type to Factor
data$Year.Month <- as.factor(data$Year.Month)

### Converting Site Column data type to Factor

data$Site <- as.factor(data$Site)

### Converting Species Column data type to Factor
data$Species <- as.factor(data$Species)
```





# MATERIALS AND METHODS


## QQNORM Test

After checking  rows and columns of data, it can be easily identified that only the average.count  data column has numerical value.  If we check  the normality of the average.count  column using the qqnorm()  function,The Below visualization data represents the relationship between the theoretical and sample quantities which  derive the plotted data is distinctly curved and determines that the data is not normal.

```{r, echo=F}
## As Mention in the Section 2 Checking for Normalizes 

qqnorm(data$average.count)
```

While  finding out that data is not normal  in  normality test using qqnorm function, if we run the same test  using  shapiro.test() function, The p-value is Greater than 0.01 we can say that it then all hypothesis is not rejected Data is not significantly  distributed  therefore we have to perform non parametric test.


```{r, echo=F}
## shapiro Test 

shapiro.test(data$average.count)
```
Since the data is not significant,in order to find out The number of seals are significantly different for each year  plot the data of average count of  number of seals   for each year but before that  we have to change the data type of the first four columns  into  factors.

```{r, echo=F}
# Checking  structure of data 
str(data)

```
After changing the data type we can find that the summer  column has  aur factor levels, Year. month column has 15 factor levels,  the site column as 7 factor level and and the species column  two factor levels.

If we see the data of average count for each year we see that the data is count is  increasing for each  year but we cannot that the changes are significant or not.

In order to find out this  we can transfer some non parametric test like kruskal Wallis rank sum test  Which help us to determine the overall correlation and   statistical Association for data by providing a chi-squared  interpretation and a p-value.

But before if we check the below graph, we can see that the 2009 has highest average count followed by 2010 and the least averge count is 2008. 


```{r, echo=FALSE}
##AVG Summer VS Month

ggplot(data,aes(x=Summer, y=average.count)) +
  geom_bar(position = "dodge",stat = "identity", width = 0.9) +
  scale_fill_manual(values = c("Blue","yellow")) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90)) + theme_bw()
```



## Kruskal-Wallis Test

In order to perform the Krukals-wallis test,   we need to use the kruskal.test() function.


```{r, echo=F}
## So After running Shaprio test we can find the our data is not data are not significantly different from normal distribution.As Our p-value is 2.2
## We will run Kruskal-Wallis Test

kruskal.test(data$average.count, data$Summer) 
```

Firstly, if we explore the overall difference between all the variables we can see that The P value is greater than 0.01, thus we can say that it There is no significant difference between the groups. In order to  explore this into more detail to find out that the pairs of groups are different or not, will use pairwise willox test For comparing different group levels for multiple testing.


```{r, echo=F}
#As the p-value is less than the significance level 0.05, we can conclude that there are significant differences between the groups.

## Running pairwise wilox Test 

pairwise.wilcox.test(data$average.count, data$Summer)
```


In the above test we can see that the P value for significant years is quite normal. further,  providing an adjustment method we can avoid the false positive results  in order to see more accuracy. 



```{r, echo=F}
## Now avoiding false-positive values for the data 
pairwise.wilcox.test(data$average.count, data$Summer,
                     p.adjust.method = "BH")
```
In the above test we can see that the  adjusted P value is greater than 0.05,  this shows that your value is not significant.  In order to understand it with more clarity  if we plot  our data we can see that there was a significant difference between 2010 and 2007,  we can see that the highest number of seals were counted in 2010. Also we can see that in 2007.
 
 
There were some high counts of seal,  but in the previous bar graph  it was suggested that there was a big significant difference between 2007 and 2010. From this we can say that the statistical tests  were more accurate  and help us to find the significant errors which were  present in data.

```{r, echo=F}

##Checking the Avg Count value difference between 2010 and 2007

plot(data$Summer, data$average.count , col = rainbow(5))
```
After this we can check the presence of the seals  for each month in a particular year. We might be able to explore the difference  for the presence of  seals  in each month of the year.


The plot below shows the values of average count for each month of particular year.We can see that in 2009 Aug,the number of species were counted the most and in 2010 Sep the species were counted the least. But in order to find significant relationship we need to explore the data and run test accordingly. 

```{r, echo=FALSE}
##AVG Species VS Month

ggplot(data,aes(x=Year.Month, y=average.count)) +
  geom_bar(position = "dodge",stat = "identity", width = 0.9) +
  scale_fill_manual(values = c("Yellow","pink")) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90))
```

### Kruskal Test For each month 

If we consider the year 2007, we can see that there is no significant difference between different months.The p-value is greater than 0.05 and the adjusted p value is also greater than 0.05.

```{r, echo=F}

### For 2007
## Exploring difference between months in 2007 using kruskal test

kruskal.test(data$average.count[data$Summer == "2007"], data$Year.Month[data$Summer == "2007"]) 
```


```{r, echo=F,error=FALSE}
## Exploring difference between months in 2007 using pairwise wilox Test 

pairwise.wilcox.test(data$average.count[data$Summer == "2007"],data$Year.Month[data$Summer == "2007"],
                     p.adjust.method = "BH")
```

If we consider the year 2008, we can see that there is no significant difference  between different months.
```{r, echo=F}

### For 2008
## Exploring difference between months in 2007 using kruskal test

kruskal.test(data$average.count[data$Summer == "2008"], data$Year.Month[data$Summer == "2008"]) 
```
```{r, echo=F,error=FALSE}
## Exploring diffrence between months in 2007 using pairwise wilox Test 

pairwise.wilcox.test(data$average.count[data$Summer == "2008"],data$Year.Month[data$Summer == "2008"],
                     p.adjust.method = "BH")
```


If we consider the year 2007, we can see that there is no significant difference  between different months.


```{r, echo=F}

### For 2009
## Exploring difference between months in 2007 using kruskal test

kruskal.test(data$average.count[data$Summer == "2009"], data$Year.Month[data$Summer == "2009"]) 
```
```{r, echo=F,error=FALSE}
## Exploring diffrence between months in 2007 using pairwise wilox Test 

pairwise.wilcox.test(data$average.count[data$Summer == "2009"],data$Year.Month[data$Summer == "2009"],
                     p.adjust.method = "BH")
```
If we consider the year 2010, we can see that there is slight significant difference  between different months.
```{r, echo=F}

### For 2010
## Exploring difference between months in 2007 using kruskal test

kruskal.test(data$average.count[data$Summer == "2010"], data$Year.Month[data$Summer == "2010"]) 
```


```{r, echo=F,error=FALSE}
## Exploring diffrence between months in 2007 using pairwise wilox Test 

print(pairwise.wilcox.test(data$average.count[data$Summer == "2010"],data$Year.Month[data$Summer == "2010"],
                     p.adjust.method = "BH"))
```



## Specices Abundance


Considering the data and previous stats we found that there were no significant difference for each month but in order to get detailed information about the species we can check the count of each type of species and find out the non-significant relationship of the data .



```{r, echo=FALSE}
##AVG Species VS Month

ggplot(data,aes(fill=Species, x=Species, y=average.count)) +
  geom_bar(position = "dodge",stat = "identity", width = 0.9) +
  scale_fill_manual(values = c("Yellow","pink")) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90))
```


As we had seen the above graph about the average count is increasing over year to year, using the kruskal test we can find out the difference between each species.



```{r, echo=F}
## Comparing species abundance

kruskal.test(data$average.count, data$Species)

```
```{r, echo=F}
## Now avoiding false-positive values for the data 
pairwise.wilcox.test(data$average.count, data$Species,
                     p.adjust.method = "BH")
```


```{r, echo=F}
## Plotting Seal avg count vs Species


plot(data$average.count ~ data$Species, col = rainbow(2))
```

After performing the test we can easily see the p values is greater than 0.01 and after plotting the below graph we can say that the Harbour seals population are more comparatively grey. In other way, it can be derived that the harbor seals are more significantly common than the grey species.

Also, we can explore data in more detailed way in order to find out significant difference of species for each year. 


If we look at the below stats, we can clearly see the p-value for 2007 year is greater than 0.05 and adjusted p-value is is also greater than 0.05 which derives there is slightest significance difference in the Species

```{r, echo=F}
## Calculating for Year 2007


kruskal.test(data$average.count[data$Summer == "2007"], data$Species[data$Summer == "2007"]) 
```

```{r, echo=F}
## Exploring diffrence between months in 2007 using pairwise wilox Test 

pairwise.wilcox.test(data$average.count[data$Summer == "2007"],data$Species[data$Summer == "2007"],
                     p.adjust.method = "BH")
```
Again, If we look at the below stats, we can clearly see the p-value for 2008 year is greater than 0.05 and adjusted p-value is is also greater than 0.05 which derives there is slightest significance difference in the Species.

```{r, echo=F}
## Calculating for Year 2008


kruskal.test(data$average.count[data$Summer == "2008"], data$Species[data$Summer == "2008"]) 
```

```{r, echo=F}
## Exploring diffrence between months in 2007 using pairwise wilox Test 

pairwise.wilcox.test(data$average.count[data$Summer == "2008"],data$Species[data$Summer == "2008"],
                     p.adjust.method = "BH")
```
Again, If we look at the below stats, we can clearly see the p-value for 2009 year is below to 0.05 and adjusted p-value is is also less than 0.05 which derives there is significance difference in the Species.


```{r, echo=F}

## Calculating for Year 2009


kruskal.test(data$average.count[data$Summer == "2009"], data$Species[data$Summer == "2009"]) 
```

```{r, echo=F}
## Exploring difference between months in 2007 using pairwise wilox Test 

pairwise.wilcox.test(data$average.count[data$Summer == "2009"],data$Species[data$Summer == "2009"],
                     p.adjust.method = "BH")
```


Finally, If we look at the below stats, we can clearly see the p-value for 2010 year is below to 0.05 and adjusted p-value is is also less than 0.05 which derives there is significance difference in the Species.


```{r, echo=F}

## Calculating for Year 2010


kruskal.test(data$average.count[data$Summer == "2010"], data$Species[data$Summer == "2010"]) 

```

```{r, echo=F}
## Exploring difference between months in 2010 using pairwise wilox Test 

pairwise.wilcox.test(data$average.count[data$Summer == "2010"],data$Species[data$Summer == "2010"],
                     p.adjust.method = "BH")
```

From this we can easily say that in 2007 and 2008 the population of species were not significantly different where as in 2009 and 2010 we can say that the population is significantly different from other.

Therefore from here we need to calculate the error in order to find the out better results and improve the performance but before that we can check the population of individual species for particular month and further we can develop the error bars after calculating the error . 




```{r, echo=FALSE}
ggplot(data,aes(fill=Species, x=Year.Month, y=average.count)) +
  geom_bar(position = "dodge",stat = "identity", width = 0.9) +
  scale_fill_manual(values = c("Yellow","pink")) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90))
```



If you look at the graph of average count of each species in a particular month everywhere we can see that the existence of herbal species are way more than the gray species.
Therefore we can say that the herbal species  are more common than the gray species.In order to find the significant differences between the species  we need to find the  error  species for particular month in each year  using SummarySE() function.

```{r, echo=FALSE}
## Error Bars
dataError <- summarySE(data,measurevar = "average.count",groupvars = c("Year.Month","Species"))

kable(head(dataError))

```


```{r, echo=FALSE}

## Species Vs SD
ggplot(dataError,aes(fill=Species, x=Year.Month, y=sd)) +
  geom_bar(position = "dodge",stat = "identity", width = 0.9) +
  scale_fill_manual(values = c("Yellow","pink")) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90))


```


```{r, echo=FALSE}

## Species Vs SE
ggplot(dataError,aes(fill=Species, x=Year.Month, y=se)) +
  geom_bar(position = "dodge",stat = "identity", width = 0.9) +
  scale_fill_manual(values = c("Yellow","pink")) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90))


```

```{r, echo=FALSE}

## Species Vs SD
ggplot(dataError,aes(fill=Species, x=Year.Month, y=ci)) +
  geom_bar(position = "dodge",stat = "identity", width = 0.9) +
  scale_fill_manual(values = c("Yellow","pink")) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90))


```



If we check  summary data   we can find that the date of it consists of count, mean,  standard deviation, standard error of mean and confidence interval. in order to find more detailed information we can plot the significant errors graph using ggplot2  in order to find significant difference between each species

```{r, echo=FALSE}
## Error plot
ggplot(dataError,aes(fill=Species, x=Year.Month, y=average.count)) +
  geom_bar(position = "dodge",stat = "identity", width = 0.9) +
  scale_fill_manual(values = c("Yellow","pink")) +
  geom_errorbar(aes(ymin=average.count-se, ymax=average.count+se),width = 0.2, position = position_dodge(0.9)) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90))



```


Considering the above graph clearly shows that the  graph provides an error bar  which significantly shows how  each species is using standard error. This clearly signifies difference  species for a particular month.


```{r, echo=F}
## Geom_Line 

ggplot(dataError,aes(fill=Species, x=Year.Month, y=average.count,group=Species)) +
  geom_line(aes(color=Species))+
  geom_point(aes(color=Species))+
  scale_fill_manual(values = c("Yellow","pink")) +
  geom_errorbar(aes(ymin=average.count-se, ymax=average.count+se),width = 0.2, position = position_dodge(0.9)) +
  theme(panel.background = element_blank(),axis.text.x = element_text(angle = 90))+
  facet_grid(Species ~ .,scales = "free")


```






# RESULTS

In the above test, we have analysed the significant  difference between the species and the count values. We have  different nominal variables and only one measure of variables,  however we are able to identify  non-significant values  of the population of seals over time.  
Moreover,  when comparing data according to the year wise,  we found out that the highest   seal was obtained in 2010 and  there were high counts in summer 2007. But they also found out that the levels of variance in the data particularly word not explored.  Therefore  we  started exploring data for each month in a year in order to find out the presence of seals, but the test suggested that there is no significant difference and different months  for each year.  Moreover, Started analysing  particular species for each year.
 Initially we had seen that the harbour seals  species are more common than grey sea species,  after that we found out 2009 and 10 the data appeared to be more significant 2007 and 2008  the data was slightly significant. After that,  we calculated the standard error,  and visualised  the data which represented how the variables are using standard errors.

  By summing up,  we can say that the data is well explored, analysed and  ready to be processed for modelling  which will help  to  give better results for prediction.



# DISCUSSION

In the above data, We were able to successfully explore and analyse and find out the normality distribution  of existence for  both the species.  According to the non parametric test,  the most common use of  Kruskal Wallis Test  is when  the data has one  nominal variable and one measurement variable  but  test  does not assume that a   data han is well distributed and completely align for two parameters which can be mean and standard deviation and also it is called as one way anova(Biostathandbook, One Way Annovas).  also this test  assumes  that the null hypothesis of mean groups are same.  therefore if  distribution groups are same, the Kruskal wallis test  will not show a significant difference in their distribution. Yet,  the test does not considered that the data are normally distributed,  which can be a big advantage but  800 data has different  groups  different variants the  test will give inaccurate result.  Therefore,  if the distribution is different and  variant is different we can use anova test for accurate results 


### REFERENCES


The Kruskal-Wallis One-way Ananysis of Variance by Ranks --Analysis of k-Between-Group Data      with a Quantitative Response Variable. Available from : https://psych.unl.edu/psycrs/handcomp/hckw.PDF. [Accessed at 20th December 2020]
Biostathandbook.com, http://www.biostathandbook.com/kruskalwallis.html [Accessed at 23d December 2020]
